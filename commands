function extractRSSLinks() {
    // Select all <a> tags with class "ext"
    const rssLinks = document.querySelectorAll('a.ext');

    // Extract href attributes
    const rssUrls = Array.from(rssLinks, link => link.href);

    return rssUrls;
}

function generateOPMLFile(rssUrls, pageTitle) {
    // Create OPML XML content
    const opmlContent = `<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>RSS Feeds - ${pageTitle}</title>
  </head>
  <body>
    ${rssUrls.map(url => `<outline text="${url}" type="rss" xmlUrl="${url}" />`).join('\n')}
  </body>
</opml>`;

    // Create a Blob from the XML content
    const blob = new Blob([opmlContent], { type: 'application/xml' });

    // Generate filename including the webpage title
    const filename = `${pageTitle.trim().replace(/\s+/g, '_').toLowerCase()}_feeds.opml`;

    // Create a download link
    const link = document.createElement('a');
    link.href = window.URL.createObjectURL(blob);
    link.download = filename;

    // Append the link to the document and trigger the click event
    document.body.appendChild(link);
    link.click();

    // Remove the link from the document
    document.body.removeChild(link);
}

// Extract page title
const pageTitle = document.title;

// Execute the functions
const rssUrls = extractRSSLinks();
generateOPMLFile(rssUrls, pageTitle);
